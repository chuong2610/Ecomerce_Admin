<!DOCTYPE html>
<html lang="en">
	<!-- Mirrored from saleszone.codeblowing.com/order-add.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 06 Jul 2025 06:05:27 GMT -->
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>SalesZone - eCommerce HTML Admin Template</title>

		<!-- Favicon Icon -->
		<link
			rel="shortcut icon"
			th:href="@{/img/icon.png}"
			type="image/x-icon"
		/>

		<!--Stylesheets-->
		<link rel="stylesheet" th:href="@{/css/plugins/bootstrap.min.css}" />
		<link rel="stylesheet" th:href="@{/css/plugins/fontawesome.min.css}" />
		<link rel="stylesheet" th:href="@{/css/plugins/select2.min.css}" />
		<link rel="stylesheet" th:href="@{/css/plugins/datepicker.min.css}" />
		<link rel="stylesheet" th:href="@{/style.css}" />
	</head>
	<body>
		<!-- Wrapper Start -->
		<div class="wrapper">
			<!-- Header Start -->
			<header class="top-header bg-primary">
				<!--Logo Here-->
				<div class="logobar">
					<div class="logo">
						<a th:href="@{/index.html}">
							<img th:src="@{/img/icon-light.png}" alt="Logo" />
							<span>SalesZone</span>
						</a>
					</div>
					<span class="toggle-bar"
						><i class="fa-solid fa-bars"></i
					></span>
				</div>
				<div class="head-content">
					<!--Notification Toggle Start-->
					<div class="nofications toggle-item d-md-block d-none">
						<div class="dropdown">
							<a
								class="icon"
								href="#"
								id="nofications"
								data-bs-toggle="dropdown"
							>
								<i class="fa-regular fa-bell"></i>
								<span>5</span>
							</a>
							<ul
								class="dropdown-menu notification-list shadow"
								aria-labelledby="nofications"
							>
								<div class="dropdown-header bg-warning">
									<strong class="text-white"
										>5 New Notification</strong
									>
								</div>
								<!--Notification Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="notification-item">
											<div class="icon">
												<i
													class="fa-solid fa-bullhorn"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong
														>New
														Notification</strong
													>
													<span>2 days ago</span>
												</div>
												<p>
													Quis quam saepe blandi tiis
													simil...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Notification Item End-->

								<!--Notification Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="notification-item">
											<div class="icon">
												<i
													class="fa-solid fa-bullhorn"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong
														>New
														Notification</strong
													>
													<span>2 days ago</span>
												</div>
												<p>
													Elige ndi amet non tenetur
													porro...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Notification Item End-->

								<!--Notification Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="notification-item">
											<div class="icon">
												<i
													class="fa-solid fa-bullhorn"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong
														>New
														Notification</strong
													>
													<span>2 days ago</span>
												</div>
												<p>
													Assu menda ducimus nemo
													laudan...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Notification Item End-->

								<!--Notification Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="notification-item">
											<div class="icon">
												<i
													class="fa-solid fa-bullhorn"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong
														>New
														Notification</strong
													>
													<span>2 days ago</span>
												</div>
												<p>
													Asper iores pariatur disti
													nctio...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Notification Item End-->

								<!--Notification Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="notification-item">
											<div class="icon">
												<i
													class="fa-solid fa-bullhorn"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong
														>New
														Notification</strong
													>
													<span>2 days ago</span>
												</div>
												<p>
													Dolor sit afrg amet conse
													ctetur...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Notification Item End-->
							</ul>
						</div>
					</div>
					<!--Notification Toggle End-->

					<!--Message Toggle Start-->
					<div class="messages toggle-item d-md-block d-none">
						<div class="dropdown">
							<a
								class="icon"
								href="#"
								id="messages"
								data-bs-toggle="dropdown"
							>
								<i class="fa-regular fa-envelope"></i>
								<span>5</span>
							</a>
							<ul
								class="dropdown-menu message-list shadow"
								aria-labelledby="messages"
							>
								<div class="dropdown-header bg-warning">
									<strong class="text-white"
										>5 New Messages</strong
									>
								</div>
								<!--Message Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="message-item">
											<div class="icon">
												<i
													class="fa-solid fa-envelope-open"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong>New Message</strong>
													<span>2 days ago</span>
												</div>
												<p>
													Quis quam saepe blandi tiis
													simil...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Message Item End-->

								<!--Message Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="message-item">
											<div class="icon">
												<i
													class="fa-solid fa-envelope-open"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong>New Message</strong>
													<span>2 days ago</span>
												</div>
												<p>
													Elige ndi amet non tenetur
													porro...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Message Item End-->

								<!--Message Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="message-item">
											<div class="icon">
												<i
													class="fa-solid fa-envelope-open"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong>New Message</strong>
													<span>2 days ago</span>
												</div>
												<p>
													Assu menda ducimus nemo
													laudan...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Message Item End-->

								<!--Message Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="message-item">
											<div class="icon">
												<i
													class="fa-solid fa-envelope-open"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong>New Message</strong>
													<span>2 days ago</span>
												</div>
												<p>
													Asper iores pariatur disti
													nctio...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Message Item End-->

								<!--Message Item Start-->
								<li>
									<a class="dropdown-item" href="#">
										<div class="message-item">
											<div class="icon">
												<i
													class="fa-solid fa-envelope-open"
												></i>
											</div>
											<div class="content">
												<div class="title">
													<strong>New Message</strong>
													<span>2 days ago</span>
												</div>
												<p>
													Dolor sit afrg amet conse
													ctetur...
												</p>
											</div>
										</div>
									</a>
								</li>
								<!--Message Item End-->
							</ul>
						</div>
					</div>
					<!--Message Toggle End-->

					<!--User Info Toggle Start-->
					<div class="current-user toggle-item">
						<div class="dropdown">
							<a
								href="#"
								id="current_user"
								data-bs-toggle="dropdown"
							>
								<img
									class="img-40px circle"
									src="img/user1.png"
									alt="Image"
								/>
							</a>
							<ul
								class="dropdown-menu shadow"
								aria-labelledby="current_user"
							>
								<li>
									<a
										class="dropdown-item"
										href="update-profile.html"
										>Profile</a
									>
								</li>
								<li>
									<a
										class="dropdown-item"
										href="employees.html"
										>Employees</a
									>
								</li>
								<li>
									<a class="dropdown-item" href="login.html"
										>Logout</a
									>
								</li>
							</ul>
						</div>
					</div>
					<!--User Info Toggle End-->
				</div>
			</header>
			<!-- Header End -->

			<!--Sidebar Start-->
			<div class="sidebar-wrapper bg-primary">
				<div class="sidebar">
					<div class="sidebar-links">
						<ul class="side-nav">
							<li class="nav-title">Backend</li>
							<li>
								<a href="index.html">
									<span
										><i class="fa-solid fa-gauge-high"></i
										>Dashboard</span
									>
								</a>
							</li>
							<li class="has-sub">
								<a href="#">
									<span
										><i class="fa-regular fa-paste"></i
										>Pages</span
									>
									<i class="fa-solid fa-angle-down"></i>
								</a>
								<ul class="submenu">
									<li>
										<a href="page-list.html">Page List</a>
									</li>
									<li>
										<a href="page-add.html">Add Page</a>
									</li>
								</ul>
							</li>
							<li class="has-sub">
								<a href="#">
									<span
										><i class="fa-solid fa-database"></i
										>Products</span
									>
									<i class="fa-solid fa-angle-down"></i>
								</a>
								<ul class="submenu">
									<li>
										<a href="product-list.html"
											>Product List</a
										>
									</li>
									<li>
										<a href="product-add.html"
											>Add Product</a
										>
									</li>
									<li>
										<a href="product-attributes.html"
											>Attributes</a
										>
									</li>
									<li>
										<a href="product-brands.html">Brands</a>
									</li>
								</ul>
							</li>
							<li>
								<a href="category-list.html">
									<span
										><i class="fa-solid fa-explosion"></i
										>Categories</span
									>
								</a>
							</li>
							<li class="has-sub">
								<a href="#">
									<span
										><i class="fa-solid fa-users"></i
										>Customers</span
									>
									<i class="fa-solid fa-angle-down"></i>
								</a>
								<ul class="submenu">
									<li>
										<a href="customer-list.html"
											>Customer List</a
										>
									</li>
									<li>
										<a href="customer-add.html"
											>Add Customer</a
										>
									</li>
								</ul>
							</li>
							<li class="has-sub">
								<a href="#">
									<span
										><i class="fa-solid fa-bag-shopping"></i
										>Orders</span
									>
									<i class="fa-solid fa-angle-down"></i>
								</a>
								<ul class="submenu">
									<li>
										<a th:href="@{/orders/order-list}"
											>Order List</a
										>
									</li>
									<li>
										<a th:href="@{/orders/order-add}"
											>Create Order</a
										>
									</li>
									<li>
										<a href="order-tracking.html"
											>Order Tracking</a
										>
									</li>
								</ul>
							</li>
							<li class="has-sub">
								<a href="#">
									<span
										><i class="fa-solid fa-location-dot"></i
										>Location</span
									>
									<i class="fa-solid fa-angle-down"></i>
								</a>
								<ul class="submenu">
									<li>
										<a href="country-list.html"
											>Country List</a
										>
									</li>
									<li>
										<a href="state-list.html">State List</a>
									</li>
									<li>
										<a href="city-list.html">City List</a>
									</li>
								</ul>
							</li>
							<li class="has-sub">
								<a href="#">
									<span
										><i class="fa-solid fa-wallet"></i
										>Payments</span
									>
									<i class="fa-solid fa-angle-down"></i>
								</a>
								<ul class="submenu">
									<li>
										<a href="payment-list.html"
											>Payment List</a
										>
									</li>
									<li>
										<a href="payment-add.html">Add New</a>
									</li>
									<li>
										<a href="invoice-list.html"
											>Invoice List</a
										>
									</li>
								</ul>
							</li>
							<li class="has-sub">
								<a href="#">
									<span
										><i class="fa-regular fa-user"></i
										>Users</span
									>
									<i class="fa-solid fa-angle-down"></i>
								</a>
								<ul class="submenu">
									<li>
										<a href="user-list.html">User List</a>
									</li>
									<li>
										<a href="user-add.html">Add User</a>
									</li>
								</ul>
							</li>
							<li>
								<a href="settings.html">
									<span
										><i class="fa-solid fa-gear"></i
										>Settings</span
									>
								</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<!--Sidebar End-->

			<!-- Main Content Area Start -->
			<main>
				<div class="main-wrapper">
					<form
						th:action="@{/orders/order-add}"
						method="post"
						id="mainOrderForm"
					>
						<div class="card p-20px mb-25px">
							<div class="card-title fw-bold font-18px mb-0">
								Create New Order
							</div>
						</div>

						<div class="card p-20px mb-25px">
							<div class="card-body">
								<div class="row">
									<div class="col-md-4">
										<h4 class="text-dark fw-bold fs-6 mb-3">
											Order Information
										</h4>
										<div class="mb-3">
											<label for="firstname"
												>Order Date</label
											>
											<input
												type="date"
												placeholder="Order Date"
												class="form-control"
											/>
										</div>
										<div class="mb-3">
											<label for="order_status"
												>Order Status</label
											>
											<select
												id="order_status"
												name="statusString"
												class="form-select select2"
											>
												<option value="">
													Select Status
												</option>
												<option
													th:each="status : ${T(org.group5.ecomerceadmin.enums.OrderStatus).values()}"
													th:value="${status.name()}"
													th:text="${status.name().charAt(0) + status.name().substring(1).toLowerCase()}"
												></option>
											</select>
										</div>
										<div class="mb-3">
											<label for="customer_select"
												>Customer</label
											>
											<select
												id="customer_select"
												name="accountId"
												class="form-select select2"
											>
												<option value="">
													Select customer
												</option>
												<option
													th:each="customer : ${customers}"
													th:value="${customer.id}"
													th:text="${customer.fullName}"
												></option>
											</select>
										</div>
									</div>
									<!-- <div class="col-md-4">
                                    <div class="billing mb-3 justify-content-between align-items-center d-flex">
                                        <h4 class="text-dark fw-bold fs-6">Billing Address</h4>
                                        <a href="#" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addBillingAddress"><i class="fa-solid fa-plus me-2"></i>Add</a>
                                    </div>

                                    <p class="mb-2"><strong>First Name: </strong><span class="text-secondary" id="billing_first_name_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Last Name: </strong><span class="text-secondary" id="billing_last_name_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Address: </strong><span class="text-secondary" id="billing_address1_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>City: </strong><span class="text-secondary" id="billing_city_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>State: </strong><span class="text-secondary" id="billing_state_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Country: </strong><span class="text-secondary" id="billing_country_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Email: </strong><span class="text-secondary" id="billing_email_preview">Not specified</span></p>
                                    <p><strong>Phone: </strong> <span class="text-secondary" id="billing_phone_preview">Not specified</span></p>
                                </div>
                                <div class="col-md-4">
                                    <div class="shipping mb-3 justify-content-between align-items-center d-flex">
                                        <h4 class="text-dark fw-bold fs-6">Shipping Address</h4>
                                        <a href="#" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addShippingAddress"><i class="fa-solid fa-plus me-2"></i>Add</a>
                                    </div>

                                    <p class="mb-2"><strong>First Name: </strong><span class="text-secondary" id="shipping_first_name_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Last Name: </strong><span class="text-secondary" id="shipping_last_name_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Address: </strong><span class="text-secondary" id="shipping_address1_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>City: </strong><span class="text-secondary" id="shipping_city_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>State: </strong><span class="text-secondary" id="shipping_state_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Country: </strong><span class="text-secondary" id="shipping_country_preview">Not specified</span></p>
                                    <p class="mb-2"><strong>Email: </strong><span class="text-secondary" id="shipping_email_preview">Not specified</span></p>
                                    <p><strong>Phone: </strong> <span class="text-secondary" id="shipping_phone_preview">Not specified</span></p>
                                </div> -->
								</div>
							</div>
						</div>
						<div class="card p-20px mb-25px">
							<div
								class="d-flex justify-content-between align-items-center"
							>
								<div class="card-title fw-bold font-18px mb-0">
									Products
								</div>
								<a
									href="#"
									class="btn btn-sm btn-primary"
									data-bs-toggle="modal"
									data-bs-target="#addProduct"
									>Add Product</a
								>
							</div>
							<div class="card-body">
								<div class="table-responsive">
									<table class="table product-table">
										<thead>
											<tr>
												<th>Name</th>
												<th>Quantity</th>
												<th>Price</th>
												<th>Total</th>
												<th
													style="
														width: 100px;
														text-align: center;
													"
												>
													Actions
												</th>
											</tr>
										</thead>
										<tbody>
											<!-- Sản phẩm sẽ được thêm động bằng JavaScript -->
										</tbody>
									</table>
								</div>
							</div>
						</div>
						<div class="card p-20px mb-25px">
							<div
								class="d-flex justify-content-between align-items-center"
							>
								<div class="card-title fw-bold font-18px mb-0">
									Order Summery
								</div>
							</div>
							<div class="card-body">
								<div class="row">
									<div class="col-md-6">
										<div class="mb-3">
											<div class="table-responsive">
												<table class="table">
													<tr>
														<th>Total:</th>
														<td
															class="order-summary-total"
														>
															$0.00
														</td>
													</tr>
												</table>
											</div>
										</div>
										<div class="order-button text-end">
											<button
												type="submit"
												class="btn btn-primary"
											>
												Create Order
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</form>
				</div>
				<!-- Footer Start -->
				<footer class="footer">
					<div class="copyright text-center">
						<span
							><i class="fa-regular fa-copyright"></i> Copyright
							by Code Blowing</span
						>
					</div>
				</footer>
				<!-- Footer End -->
			</main>
			<!-- Main Content Area End-->
		</div>
		<!-- Wrapper End -->

		<!-- Add Billing Modal -->
		<div
			class="modal fade"
			id="addBillingAddress"
			tabindex="-1"
			aria-hidden="true"
		>
			<div
				class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
			>
				<div class="modal-content">
					<form th:action="@{/orders/create}" method="post">
						<!-- Hiển thị thông báo lỗi nếu có -->
						<div
							th:if="${error}"
							class="alert alert-danger"
							role="alert"
						>
							<span th:text="${error}"></span>
						</div>
						<div class="modal-header">
							<h1 class="modal-title fs-5">
								Add Billing Address
							</h1>
							<button
								type="button"
								class="btn-close"
								data-bs-dismiss="modal"
								aria-label="Close"
							></button>
						</div>
						<div class="modal-body">
							<div class="row">
								<div class="col-md-6">
									<div class="mb-3">
										<label for="firstname"
											>First Name</label
										>
										<input
											type="text"
											id="billing_first_name"
											placeholder="First Name"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="lastname">Last Name</label>
										<input
											type="text"
											id="billing_last_name"
											placeholder="Last Name"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-12">
									<div class="mb-3">
										<label for="address1">Address</label>
										<input
											type="text"
											id="billing_address1"
											placeholder="Address Line"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="city">City</label>
										<select
											name="city"
											id="billing_city"
											class="form-select billing_select"
										>
											<option value="New York City">
												New York City
											</option>
											<option value="Toronto">
												Toronto
											</option>
											<option value="Mumbai">
												Mumbai
											</option>
											<option value="Sydney">
												Sydney
											</option>
											<option value="London">
												London
											</option>
										</select>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="state">State</label>
										<select
											name="state"
											id="billing_state"
											class="form-select billing_select"
										>
											<option value="California">
												California
											</option>
											<option value="Ontario">
												Ontario
											</option>
											<option value="Maharashtra">
												Maharashtra
											</option>
											<option value="New South Wales">
												New South Wales
											</option>
											<option value="England">
												England
											</option>
										</select>
									</div>
								</div>
								<div class="col-md-12">
									<div class="mb-3">
										<label for="country">Country</label>
										<select
											name="country"
											id="billing_country"
											class="form-select billing_select"
										>
											<option value="Bangladesh">
												Bangladesh
											</option>
											<option value="United State">
												United State
											</option>
											<option value="United Kingdom">
												United Kingdom
											</option>
											<option value="Saudi Arabia">
												Saudi Arabia
											</option>
											<option value="Canada">
												Canada
											</option>
										</select>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="email">Email Address</label>
										<input
											type="text"
											id="billing_email"
											placeholder="Email Address"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="phone">Phone</label>
										<input
											type="text"
											id="billing_phone"
											placeholder="Phone"
											class="form-control"
										/>
									</div>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button
								type="button"
								class="btn btn-danger"
								data-bs-dismiss="modal"
							>
								Close
							</button>
							<button type="submit" class="btn btn-primary">
								Insert
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- Add Shipping Modal -->
		<div
			class="modal fade"
			id="addShippingAddress"
			tabindex="-1"
			aria-hidden="true"
		>
			<div
				class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
			>
				<div class="modal-content">
					<form th:action="@{/orders/create}" method="post">
						<div class="modal-header">
							<h1 class="modal-title fs-5">
								Add Shipping Address
							</h1>
							<button
								type="button"
								class="btn-close"
								data-bs-dismiss="modal"
								aria-label="Close"
							></button>
						</div>
						<div class="modal-body">
							<div class="row">
								<div class="col-md-6">
									<div class="mb-3">
										<label for="firstname"
											>First Name</label
										>
										<input
											type="text"
											id="shipping_first_name"
											placeholder="First Name"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="lastname">Last Name</label>
										<input
											type="text"
											id="shipping_last_name"
											placeholder="Last Name"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-12">
									<div class="mb-3">
										<label for="address1">Address</label>
										<input
											type="text"
											id="shipping_address1"
											placeholder="Address Line"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="city">City</label>
										<select
											name="city"
											id="shipping_city"
											class="form-select shipping_select"
										>
											<option value="New York City">
												New York City
											</option>
											<option value="Toronto">
												Toronto
											</option>
											<option value="Mumbai">
												Mumbai
											</option>
											<option value="Sydney">
												Sydney
											</option>
											<option value="London">
												London
											</option>
										</select>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="state">State</label>
										<select
											name="state"
											id="shipping_state"
											class="form-select shipping_select"
										>
											<option value="California">
												California
											</option>
											<option value="Ontario">
												Ontario
											</option>
											<option value="Maharashtra">
												Maharashtra
											</option>
											<option value="New South Wales">
												New South Wales
											</option>
											<option value="England">
												England
											</option>
										</select>
									</div>
								</div>
								<div class="col-md-12">
									<div class="mb-3">
										<label for="country">Country</label>
										<select
											name="country"
											id="shipping_country"
											class="form-select shipping_select"
										>
											<option value="Bangladesh">
												Bangladesh
											</option>
											<option value="United State">
												United State
											</option>
											<option value="United Kingdom">
												United Kingdom
											</option>
											<option value="Saudi Arabia">
												Saudi Arabia
											</option>
											<option value="Canada">
												Canada
											</option>
										</select>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="email">Email Address</label>
										<input
											type="text"
											id="shipping_email"
											placeholder="Email Address"
											class="form-control"
										/>
									</div>
								</div>
								<div class="col-md-6">
									<div class="mb-3">
										<label for="phone">Phone</label>
										<input
											type="text"
											id="shipping_phone"
											placeholder="Phone"
											class="form-control"
										/>
									</div>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button
								type="button"
								class="btn btn-danger"
								data-bs-dismiss="modal"
							>
								Close
							</button>
							<button type="submit" class="btn btn-primary">
								Insert
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!-- Add Product -->
		<div
			class="modal fade"
			id="addProduct"
			tabindex="-1"
			aria-hidden="true"
		>
			<div
				class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
			>
				<div class="modal-content">
					<form id="addProductForm">
						<div class="modal-header">
							<h1 class="modal-title fs-5">Add Product</h1>
							<button
								type="button"
								class="btn-close"
								data-bs-dismiss="modal"
								aria-label="Close"
							></button>
						</div>
						<div class="modal-body">
							<div class="mb-3">
								<label for="product_name">Product</label>
								<select
									name="product_name"
									id="product_name"
									class="form-select"
								>
									<option value="">Select product</option>
									<option
										th:each="product : ${products}"
										th:value="${product.id}"
										th:text="${product.name}"
										th:attr="data-price=${product.price},data-quantity=${product.quantity}"
									></option>
								</select>
							</div>
							<div class="mb-3">
								<label for="product_qnty">Quantity</label>
								<input
									type="number"
									id="product_qnty"
									placeholder="Quantity"
									class="form-control"
								/>
							</div>
						</div>
						<div class="modal-footer">
							<button
								type="button"
								class="btn btn-danger"
								data-bs-dismiss="modal"
							>
								Close
							</button>
							<button type="submit" class="btn btn-primary">
								Add
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<!--Javascripts-->
		<script th:src="@{/js/plugins/jquery.min.js}"></script>
		<script th:src="@{/js/plugins/bootstrap.min.js}"></script>
		<script th:src="@{/js/plugins/select2.min.js}"></script>
		<script th:src="@{/js/plugins/datepicker.min.js}"></script>
		<script th:src="@{/js/custom.js}"></script>
		<script>
			$(document).ready(function () {
				console.log('JavaScript loaded successfully');

				// Sử dụng try-catch để tránh lỗi nếu select2 không load
				try {
					$('.select2').select2();
					$('#product_name').select2({
						dropdownParent: $('#addProduct'),
					});
					$('.shipping_select').select2({
						dropdownParent: $('#addShippingAddress'),
					});
					$('.billing_select').select2({
						dropdownParent: $('#addBillingAddress'),
					});
				} catch (error) {
					console.warn('Select2 not loaded:', error);
				}

				try {
					$('input[type="date"]').Zebra_DatePicker({
						fast_navigation: true,
						icon_position: 'right',
					});
				} catch (error) {
					console.warn('DatePicker not loaded:', error);
				}

				// JS động cho bảng sản phẩm
				let products = [];
				console.log('Products array initialized:', products);

				// Hàm render lại bảng sản phẩm
				function renderProductTable() {
					console.log(
						'Rendering product table with products:',
						products
					);
					const tbody = $('.product-table tbody');
					tbody.empty();

					if (products.length === 0) {
						tbody.append(`
			            <tr>
			              <td colspan="5" class="text-center text-muted">Chưa có sản phẩm nào được thêm</td>
			            </tr>
			          `);
						updateOrderSummary();
						return;
					}

					products.forEach((product, index) => {
						const total = (
							product.price * product.quantity
						).toFixed(2);
						tbody.append(`
			            <tr>
			              <td>
			                <h4 class="fs-6 fw-bold text-secondary">${product.name}</h4>
			              </td>
			              <td>
			                <input type="number"
			                       value="${product.quantity}"
			                       class="form-control product-qty w-85"
			                       min="1"
			                       data-id="${product.id}"
			                       style="width: 80px;">
			              </td>
			              <td><strong>$${product.price.toFixed(2)}</strong></td>
			              <td><strong>$${total}</strong></td>
			              <td class="text-center">
			                <button type="button"
			                        class="btn btn-sm btn-danger remove-product"
			                        data-id="${product.id}"
			                        title="Xóa sản phẩm">
			                  <i class="fa-solid fa-trash"></i>
			                </button>
			              </td>
			            </tr>
			          `);
					});

					updateOrderSummary();
				}

				// Thêm sản phẩm vào bảng khi nhấn Add
				$('#addProductForm').on('submit', function (e) {
					e.preventDefault();
					console.log('Add product form submitted');

					const productId = $('#product_name').val();
					const productName = $(
						'#product_name option:selected'
					).text();
					const quantity = parseInt($('#product_qnty').val());
					const price =
						parseFloat(
							$('#product_name option:selected').data('price')
						) || 0;
					const stockQuantity =
						parseInt(
							$('#product_name option:selected').data('quantity')
						) || 0;

					console.log('Product data:', {
						productId,
						productName,
						quantity,
						price,
						stockQuantity,
					});

					// Kiểm tra bắt buộc nhập sản phẩm và số lượng
					if (!productId || productId === '') {
						alert('Vui lòng chọn sản phẩm!');
						return false;
					}
					if (!quantity || quantity <= 0 || isNaN(quantity)) {
						alert('Vui lòng nhập số lượng hợp lệ!');
						return false;
					}

					// Kiểm tra dữ liệu tồn kho hợp lệ
					if (isNaN(stockQuantity) || stockQuantity <= 0) {
						alert(
							'Lỗi: Không thể lấy thông tin tồn kho của sản phẩm!'
						);
						return false;
					}

					// Kiểm tra số lượng tồn kho
					if (quantity > stockQuantity) {
						alert(
							`Không đủ hàng tồn kho! Số lượng yêu cầu: ${quantity}, Số lượng tồn kho: ${stockQuantity}`
						);
						console.log('Inventory check failed:', {
							quantity,
							stockQuantity,
						});
						return false;
					}

					// Kiểm tra nếu sản phẩm đã có trong đơn hàng
					const existingProductIndex = products.findIndex(
						(p) => p.id === productId
					);
					if (existingProductIndex !== -1) {
						// Kiểm tra tổng số lượng sau khi cộng thêm
						const newTotalQuantity =
							products[existingProductIndex].quantity + quantity;
						if (newTotalQuantity > stockQuantity) {
							alert(
								`Không đủ hàng tồn kho! Số lượng đã có trong đơn: ${products[existingProductIndex].quantity}, Số lượng muốn thêm: ${quantity}, Tồn kho: ${stockQuantity}`
							);
							console.log('Total quantity check failed:', {
								newTotalQuantity,
								stockQuantity,
							});
							return false;
						}
						// Cập nhật số lượng
						products[existingProductIndex].quantity =
							newTotalQuantity;
						console.log('Updated existing product quantity');
					} else {
						// Thêm sản phẩm mới
						products.push({
							id: productId,
							name: productName,
							quantity: quantity,
							price: price,
							stockQuantity: stockQuantity,
						});
						console.log('Added new product');
					}

					console.log('Products after adding:', products);

					// Reset form và đóng modal
					$('#product_qnty').val('');
					$('#product_name').val('').trigger('change');
					renderProductTable();
					updateSelectedProductsInput();
					$('#addProduct').modal('hide');
				});

				// Hàm cập nhật hidden input với dữ liệu sản phẩm
				function updateSelectedProductsInput() {
					if ($('#selected_products').length === 0) {
						$('#mainOrderForm').append(
							`<input type="hidden" id="selected_products" name="selectedProducts" value='' />`
						);
					}
					const productData = products.map((p) => ({
						productId: p.id,
						quantity: p.quantity,
					}));
					$('#selected_products').val(JSON.stringify(productData));
					console.log(
						'Updated hidden input:',
						JSON.stringify(productData)
					);
				}

				// Hàm cập nhật tổng tiền
				function updateOrderSummary() {
					let total = 0;
					products.forEach((p) => {
						total += parseFloat(p.price) * parseInt(p.quantity);
					});

					// Cập nhật các element tổng tiền nếu có
					$('.order-summary-total').text('$' + total.toFixed(2));
					$("table tr:contains('Total:') td:last").text(
						'$' + total.toFixed(2)
					);

					// Cập nhật subtotal nếu có
					$("table tr:contains('Subtotal:') td:last").text(
						'$' + total.toFixed(2)
					);

					console.log('Order total updated:', total);
				}

				// Xóa sản phẩm khỏi bảng
				$(document).on('click', '.remove-product', function () {
					const id = $(this).data('id');
					const productName =
						products.find((p) => p.id === id)?.name || '';

					console.log('Removing product:', id, productName);

					if (
						confirm(
							`Bạn có chắc muốn xóa sản phẩm "${productName}" khỏi đơn hàng?`
						)
					) {
						products = products.filter((p) => p.id !== id);
						renderProductTable();
						updateSelectedProductsInput();
					}
				});

				// Cập nhật số lượng khi thay đổi trong input
				$(document).on('change', '.product-qty', function () {
					const id = $(this).data('id');
					const newQty = parseInt($(this).val());
					const product = products.find((p) => p.id === id);

					console.log(
						'Quantity changed for product:',
						id,
						'new quantity:',
						newQty
					);

					if (!product) return;

					// Kiểm tra số lượng hợp lệ
					if (newQty <= 0) {
						alert('Số lượng phải lớn hơn 0!');
						$(this).val(product.quantity);
						return;
					}

					// Kiểm tra tồn kho
					if (newQty > product.stockQuantity) {
						alert(
							`Không đủ hàng tồn kho! Số lượng tồn kho: ${product.stockQuantity}`
						);
						$(this).val(product.quantity);
						return;
					}

					// Cập nhật số lượng
					product.quantity = newQty;
					renderProductTable();
					updateSelectedProductsInput();
				});

				// Khi submit form, kiểm tra bắt buộc chọn khách hàng và gom dữ liệu sản phẩm vào hidden input
				$('#mainOrderForm').on('submit', function (e) {
					console.log('Main form submitted');

					const customerId = $('#customer_select').val();
					if (!customerId || customerId === '') {
						alert('Vui lòng chọn khách hàng!');
						e.preventDefault();
						return false;
					}

					const orderStatus = $('#order_status').val();
					if (!orderStatus || orderStatus === '') {
						alert('Vui lòng chọn trạng thái đơn hàng!');
						e.preventDefault();
						return false;
					}

					if (!products || products.length === 0) {
						alert(
							'Vui lòng thêm ít nhất một sản phẩm vào đơn hàng!'
						);
						e.preventDefault();
						return false;
					}

					// Đảm bảo hidden input được cập nhật
					updateSelectedProductsInput();
					console.log('Form submission allowed');
				});

				// Initialize empty table
				renderProductTable();
			});
		</script>
		<style>
			.remove-product {
				display: inline-block !important;
				color: #fff !important;
				background: #dc3545 !important;
				border: 1px solid #dc3545 !important;
				border-radius: 4px;
				padding: 5px 8px;
				margin: 0 2px;
				font-size: 12px;
				cursor: pointer !important;
				transition: all 0.2s ease;
			}

			.remove-product:hover {
				background: #c82333 !important;
				border-color: #c82333 !important;
				color: #fff !important;
			}

			.product-table td {
				vertical-align: middle !important;
			}

			.product-qty {
				max-width: 80px !important;
				text-align: center;
			}

			.w-85 {
				width: 85px !important;
			}
		</style>
	</body>
</html>
